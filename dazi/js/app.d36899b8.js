(function(e){function t(t){for(var n,c,i=t[0],s=t[1],l=t[2],d=0,f=[];d<i.length;d++)c=i[d],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&f.push(o[c][0]),o[c]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);u&&u(t);while(f.length)f.shift()();return a.push.apply(a,l||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,i=1;i<r.length;i++){var s=r[i];0!==o[s]&&(n=!1)}n&&(a.splice(t--,1),e=c(c.s=r[0]))}return e}var n={},o={app:0},a=[];function c(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.m=e,c.c=n,c.d=function(e,t,r){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(r,n,function(t){return e[t]}.bind(null,n));return r},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="https://cdn.jsdelivr.net/gh/lin09/dist/dazi/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=s;a.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"0e0c":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("0446"),r("d13d"),r("cbf3"),r("604b");var n=r("8bbf"),o=r("9b19"),a=r.n(o),c=Object(n["createVNode"])("img",{alt:"OOS logo",src:a.a,style:{height:"32px"}},null,-1),i=Object(n["createVNode"])("div",{style:{margin:"0 8px","font-size":"18px"}},"打字练习",-1),s=Object(n["createVNode"])("a",{href:"https://www.saileidigi.cn",target:"_blank"},"saileidigi.cn",-1);function l(e,t,r,o,a,l){var u=Object(n["resolveComponent"])("router-link"),d=Object(n["resolveComponent"])("a-row"),f=Object(n["resolveComponent"])("a-layout-header"),p=Object(n["resolveComponent"])("router-view"),b=Object(n["resolveComponent"])("a-layout-content"),h=Object(n["resolveComponent"])("a-layout-footer"),j=Object(n["resolveComponent"])("a-layout");return Object(n["openBlock"])(),Object(n["createBlock"])(j,{style:{"min-height":"100vh"}},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(j,null,{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(f,{style:{background:"#fff"}},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(d,{type:"flex",align:"middle"},{default:Object(n["withCtx"])((function(){return[c,Object(n["createVNode"])(u,{to:{name:"Home"}},{default:Object(n["withCtx"])((function(){return[i]})),_:1})]})),_:1})]})),_:1}),Object(n["createVNode"])(b,null,{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(p)]})),_:1}),Object(n["createVNode"])(h,{style:{"text-align":"center"}},{default:Object(n["withCtx"])((function(){return[Object(n["createTextVNode"])(" 打字练习 v."+Object(n["toDisplayString"])(a.APP_VERSION)+" ©2020 Created by ",1),s]})),_:1})]})),_:1})]})),_:1})}var u={data:function(){return{APP_VERSION:"0.1.0"}}};r("a6fb");u.render=l;var d=u,f=r("71f8");Object(f["a"])("/dazi/service-worker.js",{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var p=r("6389"),b={style:{"margin-bottom":"20px"}},h=Object(n["createVNode"])("label",null,"类型：",-1),j={style:{"margin-bottom":"20px"}},O=Object(n["createVNode"])("label",null,"文章：",-1),v=Object(n["createTextVNode"])("开始");function m(e,t,r,o,a,c){var i=Object(n["resolveComponent"])("a-select"),s=Object(n["resolveComponent"])("a-button"),l=Object(n["resolveComponent"])("a-card"),u=Object(n["resolveComponent"])("a-row");return Object(n["openBlock"])(),Object(n["createBlock"])(u,{type:"flex",justify:"center"},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(l,{style:{"margin-top":"20px"},title:"选择文章"},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])("div",b,[h,Object(n["createVNode"])(i,{value:a.formData.sort,"onUpdate:value":t[1]||(t[1]=function(e){return a.formData.sort=e}),options:e.sorts.data,loading:e.sorts.loading,placeholder:"请选择类型",style:{width:"270px"},onChange:c.fetchArticles},null,8,["value","options","loading","onChange"])]),Object(n["createVNode"])("div",j,[O,Object(n["createVNode"])(i,{value:a.formData.id,"onUpdate:value":t[2]||(t[2]=function(e){return a.formData.id=e}),options:e.articles.data,loading:e.articles.loading,placeholder:"请选择文章",style:{width:"270px"}},null,8,["value","options","loading"])]),Object(n["createVNode"])(s,{type:"primary",block:"",onClick:c.play},{default:Object(n["withCtx"])((function(){return[v]})),_:1},8,["onClick"])]})),_:1})]})),_:1})}r("4cb6");var g=r("634d"),y=r("c6a3"),w=r("5880"),x={name:"Home",data:function(){return{formData:{sort:void 0,id:void 0}}},computed:Object(y["a"])({},Object(w["mapState"])({sorts:"sorts",articles:"articles",article:"article"})),created:function(){this.fetchSorts()},methods:Object(y["a"])(Object(y["a"])({},Object(w["mapActions"])(["getSorts","getArticles"])),{},{fetchSorts:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,t.t0=!e.sorts.data.length,!t.t0){t.next=5;break}return t.next=5,e.getSorts();case 5:t.next=9;break;case 7:t.prev=7,t.t1=t["catch"](0);case 9:e.sorts.data.length&&(e.formData.sort=e.articles.sort||e.sorts.data[0].value,e.fetchArticles());case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},fetchArticles:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getArticles(e.formData.sort);case 3:t.next=7;break;case 5:t.prev=5,t.t0=t["catch"](0);case 7:e.articles.data.length&&(e.article.data.id&&e.article.data.sort.id===e.formData.sort?e.formData.id=e.article.data.id:e.formData.id=e.articles.data[0].value);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))()},play:function(){this.formData.id?this.$router.push({name:"Play",params:{id:this.formData.id}}):this.$message.error("没有选择文章")}})};x.render=m;var N=x,V=(r("0090"),Object(n["withScopeId"])("data-v-c2255d52"));Object(n["pushScopeId"])("data-v-c2255d52");var S={key:0,class:"tab"},k={style:{"border-bottom":"1px solid #f0f0f0"}},_=Object(n["createVNode"])("span",null,"用时：",-1),C={style:{"border-bottom":"1px solid #f0f0f0"}},D=Object(n["createVNode"])("span",null,"速度：",-1),A={style:{"border-bottom":"1px solid #f0f0f0"}},B=Object(n["createVNode"])("span",null,"总字数：",-1),T={style:{"border-bottom":"1px solid #f0f0f0"}},P=Object(n["createVNode"])("span",null,"正确率：",-1),M=Object(n["createVNode"])("span",null,"错误：",-1);Object(n["popScopeId"])();var W=V((function(e,t,r,o,a,c){var i=Object(n["resolveComponent"])("Word"),s=Object(n["resolveComponent"])("a-card"),l=Object(n["resolveComponent"])("a-row"),u=Object(n["resolveComponent"])("a-modal");return Object(n["openBlock"])(),Object(n["createBlock"])(l,{type:"flex",justify:"center"},{default:V((function(){return[Object(n["createVNode"])(s,{loading:e.article.loading,style:{margin:"20px 10px",width:"1200px"}},Object(n["createSlots"])({default:V((function(){return[Object(n["createVNode"])("div",{class:"content",onClick:t[5]||(t[5]=function(){return c.focus&&c.focus.apply(c,arguments)})},[Object(n["withDirectives"])(Object(n["createVNode"])("textarea",{ref:"textarea","onUpdate:modelValue":t[1]||(t[1]=function(e){return a.value=e}),style:a.textareaStyle,onKeydown:t[2]||(t[2]=Object(n["withKeys"])(Object(n["withModifiers"])((function(){}),["prevent"]),["enter","up","down","left","right"])),onBlur:t[3]||(t[3]=function(){return c.pause&&c.pause.apply(c,arguments)}),onFocus:t[4]||(t[4]=function(){return c.restore&&c.restore.apply(c,arguments)})},null,36),[[n["vShow"],!a.isDone],[n["vModelText"],a.value]]),(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(e.article.data.words,(function(t,r){return Object(n["openBlock"])(),Object(n["createBlock"])("div",{key:r},[1===e.article.data.sort.id?(Object(n["openBlock"])(),Object(n["createBlock"])("span",S)):Object(n["createCommentVNode"])("",!0),(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(t,(function(e,t){return Object(n["openBlock"])(),Object(n["createBlock"])(i,{ref:"word".concat(a.inputWords.length-1===r&&t===a.inputWords[r].length?"Active":""),key:t,word:e,value:a.inputWords[r]?a.inputWords[r][t]:void 0,active:a.inputWords.length-1===r&&t===a.inputWords[r].length},null,8,["word","value","active"])})),128))])})),128))])]})),_:2},[e.article.data.id?{name:"title",fn:V((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.article.data.title)+" ",1),e.article.data.author.name?(Object(n["openBlock"])(),Object(n["createBlock"])(n["Fragment"],{key:0},[Object(n["createTextVNode"])(" - "+Object(n["toDisplayString"])(e.article.data.author.name),1)],64)):Object(n["createCommentVNode"])("",!0)]}))}:void 0,e.article.data.id?{name:"extra",fn:V((function(){return[Object(n["createTextVNode"])(" 类型："+Object(n["toDisplayString"])(e.article.data.sort.label),1)]}))}:void 0,e.article.data.id?{name:"actions",fn:V((function(){return[Object(n["createVNode"])("span",null,"用时："+Object(n["toDisplayString"])(c.time),1),Object(n["createVNode"])("span",null,"速度："+Object(n["toDisplayString"])(c.wpm)+" WPM",1),Object(n["createVNode"])("span",null,"总字数："+Object(n["toDisplayString"])(a.value.length),1),Object(n["createVNode"])("span",null,"正确率："+Object(n["toDisplayString"])(c.correctRate)+"%",1),Object(n["createVNode"])("span",null,"错误："+Object(n["toDisplayString"])(c.errorNum),1)]}))}:void 0]),1032,["loading"]),Object(n["createVNode"])(u,{visible:a.doneModalVisible,"onUpdate:visible":t[6]||(t[6]=function(e){return a.doneModalVisible=e}),maskClosable:!1,width:300,title:"打字练习结束",okText:"重新开始",cancelText:"取消",onOk:c.reset},{default:V((function(){return[Object(n["createVNode"])("p",k,[Object(n["createVNode"])(l,{type:"flex",justify:"space-between"},{default:V((function(){return[_,Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(c.time),1)]})),_:1})]),Object(n["createVNode"])("p",C,[Object(n["createVNode"])(l,{type:"flex",justify:"space-between"},{default:V((function(){return[D,Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(c.wpm)+" WPM",1)]})),_:1})]),Object(n["createVNode"])("p",A,[Object(n["createVNode"])(l,{type:"flex",justify:"space-between"},{default:V((function(){return[B,Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(a.value.length),1)]})),_:1})]),Object(n["createVNode"])("p",T,[Object(n["createVNode"])(l,{type:"flex",justify:"space-between"},{default:V((function(){return[P,Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(c.correctRate)+"%",1)]})),_:1})]),Object(n["createVNode"])(l,{type:"flex",justify:"space-between",style:{"border-bottom":"1px solid #f0f0f0"}},{default:V((function(){return[M,Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(c.errorNum),1)]})),_:1})]})),_:1},8,["visible","onOk"])]})),_:1})})),I=(r("4739"),r("19b2"),r("9679"),r("d10d"),r("0988"),r("1b10"),Object(n["withScopeId"])("data-v-963b66a8"));Object(n["pushScopeId"])("data-v-963b66a8");var R={class:"word"};Object(n["popScopeId"])();var $=I((function(e,t,r,o,a,c){return Object(n["openBlock"])(),Object(n["createBlock"])("span",R,[Object(n["createVNode"])("span",{style:c.style},Object(n["toDisplayString"])(r.word),5),Object(n["createVNode"])("span",{class:["value",{active:r.active}]},Object(n["toDisplayString"])(r.value),3)])})),F={props:{word:String,value:String,active:Boolean},computed:{style:function(){var e={};return void 0!==this.value&&this.word!==this.value&&(e.background="#f5222d"),e}}};r("e236");F.render=$,F.__scopeId="data-v-963b66a8";var U=F,E={name:"Play",components:{Word:U},data:function(){return{value:"",inputWords:[""],second:0,textareaStyle:{},isDone:!1,doneModalVisible:!1}},computed:Object(y["a"])(Object(y["a"])({},Object(w["mapState"])({article:"article"})),{},{errorNum:function(){var e=this.value.replace(/(\n|\r|↵)/g,""),t=this.article.data.content.replace(/(\n|\r|↵)/g,""),r=0;for(var n in e)e[n]!==t[n]&&++r;return r},correctRate:function(){return this.value.length?((this.value.length-this.errorNum)/this.value.length*100).toFixed(2):0},time:function(){return(Math.floor(this.second/60)+"").padStart(2,"0")+":"+(this.second%60+"").padStart(2,"0")},wpm:function(){return this.second&&Math.floor(this.value.length/(this.second/60))}}),watch:{value:function(e,t){var r=this;if(e.length>this.article.data.content.length)this.value=e.slice(0,this.article.data.content.length);else{this.inputWords=e.replace(/(\n|\r|↵)/g,"--_,_--").split("--_,_--");var n=this.inputWords.length-1,o=this.inputWords[n].length-this.article.data.words[n].length;if(this.inputWords.length<this.article.data.words.length&&0===o)this.inputWords.push("");else if(o>0){var a=e.length-o;this.value=e.slice(0,a)+"↵"+e.slice(a)}else this.$nextTick((function(){r.handleTextareaStyle()})),e?t?e.length===this.article.data.content.length&&(this.pause(),this.isDone=!0,this.doneModalVisible=!0):(this.second=0,this.start()):(this.second=0,this.pause())}}},created:function(){this.getArticle(this.$route.params.id)},beforeUnmount:function(){this.pause()},methods:Object(y["a"])(Object(y["a"])({},Object(w["mapActions"])(["getArticle"])),{},{start:function(){var e=this;if(!this.isDone){var t=function t(){++e.second,clearTimeout(e.start.timeout),e.start.timeout=setTimeout(t,1e3)};clearTimeout(this.start.timeout),this.start.timeout=setTimeout(t,1e3)}},pause:function(){clearTimeout(this.start.timeout)},restore:function(){this.handleTextareaStyle(),this.second&&this.start()},focus:function(){var e=this;this.isDone?this.doneModalVisible=!0:(this.handleTextareaStyle(),this.$nextTick((function(){e.$refs.textarea.focus()})))},handleTextareaStyle:function(){if(this.$refs.wordActive){var e=this.textareaStyle.top;this.textareaStyle={top:this.$refs.wordActive.$el.offsetTop+44+"px",left:this.$refs.wordActive.$el.offsetLeft+"px"},e!==this.textareaStyle.top&&this.$refs.wordActive.$el.offsetTop&&scrollTo({top:scrollY+108,behavior:"smooth"})}},reset:function(){this.isDone=!1,this.doneModalVisible=!1,this.value="",scrollTo({top:0,behavior:"smooth"})}})};r("ff34");E.render=W,E.__scopeId="data-v-c2255d52";var J=E,z=Object(n["createVNode"])("h1",null,"404 NotFound",-1);function H(e,t){var r=Object(n["resolveComponent"])("a-row");return Object(n["openBlock"])(),Object(n["createBlock"])(r,{type:"flex",justify:"center"},{default:Object(n["withCtx"])((function(){return[z]})),_:1})}const L={};L.render=H;var q=L,K=[{path:"/",name:"Home",component:N},{path:"/:id(\\d+)",name:"Play",component:J},{path:"/:pathMatch(.*)*",name:"NotFound",component:q}],Y=Object(p["createRouter"])({history:Object(p["createWebHistory"])("/dazi"),routes:K}),G=Y,Q=(r("98e6"),r("5e14"),r("cebe")),X=r.n(Q),Z="token_s_2",ee=function(e){var t={};try{t=JSON.parse(atob((e+"").replace(/(.+)\..+/,"$1")))}catch(r){window.console.error(r)}return t},te=function(e){var t=ee(e);return!(!t.exp||2!==t.sid)&&t.exp>new Date/1e3+1800},re=function(){var e=localStorage.getItem(Z);return e&&te(e)?e:""},ne=function(e){return!!te(e)&&(localStorage.setItem(Z,e),!0)},oe=!1,ae=function(e){var t=X.a.create(e);return t.interceptors.request.use((function(e){return e.headers.auth="/login"===e.url?"visitor":re(),e}),(function(e){return window.antd.notification.error({message:e.message}),Promise.reject(e)})),t.interceptors.response.use((function(e){return e.data}),(function(e){if("Network Error"===e.message){if(oe)return Promise.reject(e);oe=!0}return window.antd.notification.error({message:e.response&&e.response.status||e.message,description:e.response&&e.response.data}),Promise.reject(e)})),t},ce=ae({baseURL:"https://system-api.oos.saileidigi.cn"}),ie=function(){var e=re();return e?Promise.resolve(e):ce.post("/login",{sid:2,h:"5d53b127a2d418887a52d659c318a90e"}).then(ne)},se=function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.t0=!re(),!e.t0){e.next=4;break}return e.next=4,ie();case 4:if(re()){e.next=7;break}return window.antd.notification.error({message:"受权失败"}),e.abrupt("return",Promise.reject("受权失败"));case 7:return e.abrupt("return",ce.post("query/"+t,r));case 8:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),le=function(e){return se("all",e)},ue=r("eac8"),de=function(e,t){"object"===Object(ue["a"])(t)&&(t=JSON.stringify(t)),localStorage.setItem(e,t)},fe=function(e){var t=localStorage.getItem(e);try{t=JSON.parse(t)}catch(r){}return t},pe=Object(w["createStore"])({state:{sorts:{loading:!1,data:[]},articles:{sort:0,loading:!1,data:[]},article:{loading:!1,data:{}}},mutations:{setSorts:function(e,t){e.sorts=Object(y["a"])(Object(y["a"])({},e.sorts),t)},setArticles:function(e,t){e.articles=Object(y["a"])(Object(y["a"])({},e.articles),t)},setArticle:function(e,t){e.article=Object(y["a"])(Object(y["a"])({},e.article),t)}},actions:{getSorts:function(e){var t=e.commit,r=fe("sorts")||[];return t("setSorts",{loading:!0,data:r}),le({table:{name:"sort",no_default_field:!0,fields:["id","label"],filters:[[["state","=",1]]]}}).then((function(e){var r=e.data;r=r.map((function(e){return{value:e.id,label:e.label}})),t("setSorts",{data:r}),de("sorts",r)})).finally((function(){t("setSorts",{loading:!1})}))},getArticles:function(e,t){var r=e.commit,n=e.state;if(n.articles.sort===t||!t)return Promise.resolve();var o="articles-"+t,a=fe(o)||[];return r("setArticles",{loading:!0,data:a,sort:t}),le({table:{name:"article",no_default_field:!0,fields:["id","title","author"],filters:[[["state","=",1],["sort","=",t]]]}}).then((function(e){var n=e.data;n=n.map((function(e){var t=e.title;return e.author.name&&(t+=" - "+e.author.name),{value:e.id,label:t}})),r("setArticles",{data:n,sort:t}),de(o,n)})).finally((function(){r("setArticles",{loading:!1})}))},getArticle:function(e,t){var r=e.commit,n=e.state;if(n.article.data.id===1*t||!t)return Promise.resolve();var o="article-"+t,a=fe(o)||{};return r("setArticle",{loading:!0,data:a}),le({table:{name:"article",no_default_field:!0,fields:["id","title","author","content","sort"],filters:[[["state","=",1],["id","=",t]]]}}).then((function(e){var t=e.data;t=t[0]||{},t.content&&(t.words=t.content.replace(/(\n|\r|↵)/g,"--_,_--").split("--_,_--")),r("setArticle",{data:t}),de(o,t)})).finally((function(){r("setArticle",{loading:!1})}))}}});document.getElementById("loading").style.display="none";var be=Object(n["createApp"])(d);be.use(window.antd).use(pe).use(G).mount("#app")},5880:function(e,t){e.exports=Vuex},6389:function(e,t){e.exports=VueRouter},"78fa":function(e,t,r){},"8bbf":function(e,t){e.exports=Vue},9541:function(e,t,r){},"9b19":function(e,t,r){e.exports=r.p+"img/logo.99ba0864.svg"},a6fb:function(e,t,r){"use strict";r("0e0c")},cebe:function(e,t){e.exports=axios},e236:function(e,t,r){"use strict";r("78fa")},ff34:function(e,t,r){"use strict";r("9541")}});
//# sourceMappingURL=app.d36899b8.js.map